# T9 セキュリティ評価レポート

## 実施日
2026-02-08

## 対象範囲
- `src/App.tsx` - メインアプリケーションロジック
- `src/main.tsx` - アプリケーションエントリーポイント
- `src/pages/Home.tsx` - ホームページコンポーネント

## 1. セキュリティ評価結果

### 1.1 XSS（クロスサイトスクリプティング）脆弱性

#### 結論: **検出されません（低リスク）**

Reactを使用しているため、デフォルトでXSS防护が有効です。評価点：

| 項目 | 状態 | 詳細 |
|------|------|------|
| ユーザー入力のレンダリング | 安全 | ReactのJSXは自動的にエスケープ |
| dangerouslySetInnerHTML | 未使用 | 危険なHTML挿入は使用されていません |
| イベントハンドラー | 安全 | onChange等のハンドラーはReactの仕組みに従っている |

#### 検証したコード箇所:
- `App.tsx:342` - 材料名のテキスト入力: `<input type="text" ... value={ing.name} />`
- `App.tsx:306` - 計算結果の表示: Reactによる自動エスケープ

**特記事項:** `Home.tsx`で絵文字（🍳, 📖等）を直接ハードコードしていますが、これらは静的文字列であり安全です。

### 1.2 データ保存の安全性

#### 結論: **該当なし（クライアントサイドのみ）**

現在の実装では永続的なデータ保存機能が実装されていません：

- ローカルストレージ/セッションストレージ: 未使用
- Cookie: 未使用
- 外部API通信: 未使用

すべての状態はReactのuseStateによってメモリ上で管理されています。

### 1.3 数値入力の妥当性チェック

#### 結論: **適切に実装されています**

| 項目 | 実装 | コード箇所 |
|------|------|-----------|
| NaNチェック | 有り | `isNumericString()` 関数で実装 |
| 0除算対策 | 有り | `targetWNum === 0 ? 0 : ...` (行146-148) |
| 数値変換 | 安全 | `Number()` + `isNaN()` の組み合わせ |

### 1.4 その他のセキュリティ評価

| 項目 | 状態 | 詳細 |
|------|------|------|
| Content Security Policy | 未設定 | HTMLにmetaタグなし |
| Subresource Integrity | 不要 | 外部CDN未使用 |
| 依存関係 | 要監視 | npmパッケージの定期更新推奨 |
| HTTPS | 環境依存 | デプロイ時の設定 |

### 1.5 エッジケースの対応

実装されているエッジケース対応：

1. **空文字列入力** - `isNumericString()` で空文字を判定
2. **NaN値の伝播防止** - 数値計算前に`isNaN()`でチェック
3. **0除算の防止** - ワット数変換で0除算を回避

## 2. セキュリティベストプラクティスの適用状況

| ベストプラクティス | 適用状態 | 備考 |
|--------------------|----------|------|
| React StrictMode | 適用 | main.tsxで有効 |
| TypeScript | 適用 | 型安全性の確保 |
| ユーザー入力のサニタイズ | 自動 | Reactによる自動エスケープ |
| 入力妥当性チェック | 適用 | 数値入力のバリデーション |
| CSPヘッダー | 未適用 | 推奨（後述） |

## 3. 改善提案

### 3.1 高優先度（推奨）

1. **Content Security Policy (CSP) の追加**

   `index.html` にCSP metaタグを追加することを推奨：

   ```html
   <meta http-equiv="Content-Security-Policy" content="
     default-src 'self';
     script-src 'self';
     style-src 'self' 'unsafe-inline';
     img-src 'self' data:;
     connect-src 'self';
   ">
   ```

   **理由:** インラインスクリプトや外部リソースの読み込みを制限し、XSS攻撃のリスクを低減

2. **入力範囲の制限**

   数値入力フィールドに`min`, `max`属性を追加：

   ```tsx
   <input type="number" min="0" max="10000" ... />
   ```

   **理由:** 不正な値や極端に大きな値によるUI崩壊を防止

### 3.2 中優先度（検討）

1. **数値精度の改善**

   現在の実装では`toFixed(2)`を使用していますが、計算の過程で浮動小数点エラーが蓄積する可能性があります。

   **提案:** 計算用ライブラリ（Decimal.jsなど）の検討

2. **ステート永続化時の安全対策**

   将来的にlocalStorage等を使用する場合、データのシリアライズ/デシリアライズ時にバリデーションを追加してください。

### 3.3 低優先度（オプション）

1. **依存関係のスキャン**

   `npm audit` を定期的に実施し、脆弱なパッケージを更新してください。

2. **アクセシビリティの改善**

   `aria-label`属性を追加することで、セキュリティとアクセシビリティの両面で改善できます。

## 4. 総合評価

| 評価項目 | スコア | メモ |
|----------|--------|------|
| XSS対策 | A | Reactの自動エスケープにより安全 |
| 入力バリデーション | A | 適切に実装されている |
| データ保護 | A | クライアントサイドのみで問題なし |
| ベストプラクティス | B | CSPの追加を推奨 |
| **総合** | **A-** | 全体的に良好 |

## 5. 結論

T4およびT5の実装について、重大なセキュリティ脆弱性は検出されませんでした。

Reactの標準的な機能（自動XSSエスケープ、StrictMode）とTypeScriptによる型安全性により、基本的なセキュリティ要件は満たされています。

推奨事項として、CSPヘッダーの追加と入力範囲の制限を実装することで、より堅牢なアプリケーションになります。

---

**レビューア:** Sec担当（T9）
**ステータス:** レビュー完了
